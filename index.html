<!DOCTYPE html>
{% autoescape true %}
<html>
<head>
  <link type="text/css" rel="stylesheet" href="/stylesheets/main.css" />

<!-- DataTables CSS -->
<link rel="stylesheet" type="text/css" href="//cdn.datatables.net/1.10.2/css/jquery.dataTables.css">
  
<!-- jQuery -->
<script type="text/javascript" charset="utf8" src="//code.jquery.com/jquery-1.10.2.min.js"></script>
  
<!-- DataTables -->
<script type="text/javascript" charset="utf8" src="//cdn.datatables.net/1.10.2/js/jquery.dataTables.js"></script>

<script type="text/javascript">
$(document).ready( function () {
  $.fn.dataTableExt.afnFiltering.push(function(oSettings, aData, iDataIndex) {
        var checked = $('#checkbox').is(':checked');
        if (checked)
          return aData[6] != "True";
        else
          return true
    });

    var oTable = $('#hit_table').dataTable({
      "order": [[7, "desc"]]
    });

    $('#checkbox').on("click", function(e) {
        console.log('click');
        oTable.fnDraw();
        console.log("num is " + oTable.fnSettings().fnRecordsDisplay());
        var numRows = oTable.fnSettings().fnRecordsDisplay();
        $('#num_entries').html(numRows);
    });

} );
</script>

</head>
  <body>
    <h1>ami phone home</h1>

    <table id="hit_table" class="display">
      <thead>
        <tr>
        <th>ami-id</th>
        <th>bioc version</th>
        <th>ami name</th>
        <th>instance type</th>
        <th>region</th>
        <th>availability zone</th>
        <th>is bioc account</th>
        <th>date</th>
      </tr>
      </thead>
      <tbody>
{% for hit in hits %}
      <tr>
        <td>{{hit.ami_id}}</td>
        <td>{{hit.bioc_Version}}</td>
        <td>{{hit.ami_name}}</td>
        <td>{{hit.instance_type}}</td>
        <td>{{hit.region}}</td>
        <td>{{hit.availability_zone}}</td>
        <td>{{hit.is_bioc_account}}</td>
        <td>{{hit.date}}</td>

      </tr>
{% endfor %}
      </tbody>
    </table>


    <hr>

    <p>Number of entries: <span id="num_entries">{{numhits}}</span></p>
    <p><input type="checkbox" id="checkbox"/> Hide BioC hits</p>

  </body>
</html>
{% endautoescape %}
